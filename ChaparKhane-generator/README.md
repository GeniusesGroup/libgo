# ChaparKhane Generator


## How to use!
### API As a Service
Call needed service functions (APIs) from generator repository(folder).

### SabzCity Version Control
- Add ChaparKhane as dependency to project.
- Set interval time to build and run platform app on specify domain.

### cli
See related [README](/cli)

## Logic service standard
To write better business logic read these advices! A lot of way exist to handle service versions like  [Git Basics - Tagging](https://git-scm.com/book/en/v2/Git-Basics-Tagging), [Semantic Versioning](https://semver.org/) But we decide very innovative way explain below.

### Folders
Folders use just to group same logic APIs to separate logic by stateful data. Just one rule and is to start services folder with `service--` e.g. `service--authentication`

### File
You must follow this rules:
- Split each service (exported function) in one file to appreciate NanoService pattern!
- Add a unique ID (uint32) to end of function-name e.g. `function-name--000.go` and it must start as 65537 due to use first 2^16 of IDs for internal or standard server services!    
CAUTION : DON'T REUSE OLD ID EVEN IF YOU DON'T NEED THEM EVER!
- Add a date to end of file name in this format "--year-month-day" e.g. `function-name--000--20201230.go` to express deprecate exported services(functions). In this way generator just use if date is not pass! Date 00000000 means no expire time until now set!
- To indicate an exported function not ready (version 0) and may API changes just add a dash - in the end of file name e.g. `function-name--000--00000000-.go`

### Function
- Name :
  - As always use full detail name.
  - Always add ID to end of function name for reusability of function name.
- parameters & results:
  - Use these structure tags:
    - valid : specify function name to validate data.
    - value : specify default value
    - http : specify location of data in http packet. e.g. header:, header:x:, header:cookie:, body, ...

### DataStore layer:
- Just call owner data store and call other service function if need others data!
- make new PersiaDB folder and datastore-structure file in each service if needed, NEVER EDIT EXITING STRUCTURE!

## Done in autogenerate layers
- Serialize and deserialize data format like json, xml, binary, ... would be faster up to 5x because of not use of reflection   
  e.g. https://github.com/mailru/easyjson , https://github.com/pquerna/ffjson
- Check & validate request data
- Make handlers to receive data and call service functions.
- Make API documentation in many standards e.g. OpenAPI(Swagger), ...
- Make SDK in multi language & system e.g. Go, TS, ...

## What is prohibited?
- Autogenerated code should not be edited, since it may be automatically overwritten by the same process.
- Don't use minor version for service breaking changes! We just use major version number to versioning API.
